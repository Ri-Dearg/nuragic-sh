{% extends 'base/base.html' %}
<!-- Loads internationalization, loads static, loads crispy forms  -->
{% load static %} {% load i18n %} {% load crispy_forms_tags %}

{% block head_title %}{{ user.username }}{% endblock%}

<!-- Open Graph Tags -->
{% block og_type %}website{% endblock %}
{% block og_title %}{% trans 'Ancient Wisdom, Modern Healing' %}{% endblock %}
{% block og_description %}{% trans 'Consciousness, spirituality, healing and ancestry. Working with systems such as Tarot, Oracle Cards, Shamanic Drumming and Healing. Creating events for sharing and connections between individuals and cultures.' %}{% endblock %}
{% block og_image %}{% static 'open_graph/logo1200x630.png' %}{% endblock %}
{% block og_image_type %}image/png{% endblock %}
{% block og_image_width %}1200{% endblock %}
{% block og_image_height %}630{% endblock %}
{% block og_image_alt %}Nuragic Shamanic Healing Logo{% endblock %}
{% include 'base/includes/open_graph_basic.html'%}

{% block content %}
<!-- This page displays option such as changing password, email address and shipping/billing info.
The email and password functions use django-allauth logic with custom forms.
Much of the content is taken directly from their templates. -->
<div class="row py-3 bg-brown">
    <div class="col">
        <h2 class="h-font l-space-1 h1 text-white text-center">{{ user.username|upper }}{% trans "'S SETTINGS" %}</h2>
    </div>
</div>
<div class="row bg-white">
    <div class="col-12 col-md-6 p-2 p-md-4">
        {% include 'users/includes/email.html' %}
    </div>
    <hr class="d-md-none my-3" />
    <div class="col-12 col-md-6 p-2 p-md-4">
        {% include 'users/includes/password_change.html' %}
    </div>
</div>
<div class="row bg-white">
    <div class="col-12">
        <hr class="my-md-0 my-3" />
    </div>
    <form action="{% url 'users:shipping-billing' %}?next={{ request.path }}" method="POST">
        <div class="row mx-0">
            <div class="col-12 col-md-6 p-2 p-md-4">
                {% csrf_token %}
                <!-- Allows the user to set shipping and billing details, no fields are required. -->
                <fieldset class="mb-3">
                    <legend class="h-font l-space-1 text-primary">{% trans 'SHIPPING DETAILS' %}</legend>
                    {{ user_profile_detail.shipping_full_name|as_crispy_field }}
                    {{ user_profile_detail.shipping_phone_number }}
                    <div class="mt-3"></div>
                    {{ user_profile_detail.shipping_street_address_1|as_crispy_field }}
                    {{ user_profile_detail.shipping_street_address_2|as_crispy_field }}
                    {{ user_profile_detail.shipping_town_or_city|as_crispy_field }}
                    {{ user_profile_detail.shipping_county|as_crispy_field }}
                    {{ user_profile_detail.shipping_postcode|as_crispy_field }}
                    {{ user_profile_detail.shipping_country }}
                    <button type="submit" class="btn btn-sm btn-primary d-none d-md-block mt-3">Submit</button>
                </fieldset>
                <hr class="d-md-none my-3" />
            </div>
            <div class="col-12 col-md-6 p-2 p-md-4">
                <fieldset class="mb-3">
                    <legend class="h-font l-space-1 text-primary">{% trans 'BILLING INFORMATION' %}</legend>
                    {{ user_profile_detail.billing_full_name|as_crispy_field }}
                    {{ user_profile_detail.billing_phone_number }}
                    <div class="mt-3"></div>
                    {{ user_profile_detail.billing_street_address_1|as_crispy_field }}
                    {{ user_profile_detail.billing_street_address_2|as_crispy_field }}
                    {{ user_profile_detail.billing_town_or_city|as_crispy_field }}
                    {{ user_profile_detail.billing_county|as_crispy_field }}
                    {{ user_profile_detail.billing_postcode|as_crispy_field }}
                    {{ user_profile_detail.billing_country }}
                    <button type="submit" class="btn btn-sm btn-primary d-md-none mt-3">Save</button>
                </fieldset>
            </div>
        </div>
    </form>
    {% endblock %} {% block postloadjs %} {{ block.super }}
    <script type="text/javascript">
        // Script taken from django-allauth
        (function () {
            var message = "Do you really want to remove the selected e-mail address?";
            var actions = document.getElementsByName("action_remove");
            if (actions.length) {
                actions[0].addEventListener("click", function (e) {
                    if (!confirm(message)) {
                        e.preventDefault();
                    }
                });
            }
        })();
    </script>
    {% endblock %}
